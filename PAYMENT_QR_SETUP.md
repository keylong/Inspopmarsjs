# 收款二维码配置指南

## 重要说明

你的支付网关集成已经完成，但收款二维码需要在支付网关后台进行配置。目前显示的是演示二维码。

## 收款码配置步骤

### 1. 获取收款码

**支付宝收款码：**
1. 打开支付宝APP
2. 点击首页"收钱"
3. 点击"设置金额"
4. 保存收款码图片

**微信收款码：**
1. 打开微信APP
2. 点击右上角"+"号
3. 选择"收付款"
4. 选择"二维码收款"
5. 保存收款码图片

### 2. 上传到支付网关

1. 访问支付网关管理后台: https://pay.chats2gpt.com
2. 登录到管理界面
3. 找到"收款码管理"或"支付配置"页面
4. 分别上传支付宝和微信的收款码图片
5. 保存配置

### 3. 配置完成后的效果

配置完成后，用户在支付时会看到你配置的真实收款码，而不是演示二维码。

## 技术实现说明

### 当前的处理流程

1. 用户选择支付方式
2. 系统创建订单
3. 尝试从支付网关获取收款码 (`/api/payment/qr-code`)
4. 如果获取失败，显示演示二维码
5. 用户扫码支付
6. 支付网关检测到收款并回调系统
7. 系统激活用户会员权益

### API接口说明

**获取收款码接口：** `GET /api/payment/qr-code`

参数：
- `method`: 支付方式 (alipay/wechat)
- `orderId`: 订单ID

响应：
```json
{
  "success": true,
  "qrCodeUrl": "https://支付网关域名/qr/收款码图片地址",
  "message": "获取收款码成功"
}
```

## 测试步骤

### 1. 配置前测试
- 访问订阅页面
- 点击支付按钮
- 会看到演示二维码和相关提示

### 2. 配置后测试
- 在支付网关后台配置收款码
- 重新测试支付流程
- 应该看到真实的收款码

### 3. 完整支付测试
- 使用真实收款码
- 进行小额测试支付 (0.01元)
- 确认回调和会员激活功能

## 故障排除

### Q: 为什么显示"请联系管理员配置"？
A: 收款码未在支付网关后台配置，请按照上述步骤配置收款码。

### Q: 配置了收款码但还是显示演示二维码？
A: 
1. 检查支付网关后台配置是否保存成功
2. 确认支付网关API接口是否正常
3. 查看浏览器控制台是否有错误信息

### Q: 支付成功但订阅未激活？
A: 
1. 检查回调URL是否可以正常访问
2. 确认转账金额是否与订单金额完全一致
3. 查看支付网关的匹配规则设置

## 联系支持

如需技术支持，请提供：
1. 支付网关管理后台截图
2. 浏览器控制台错误信息
3. 支付测试的详细步骤

---

**更新时间**: 2025年1月13日